Note: Environment variable`HF_TOKEN` is set and is the current active token independently from the token you've just configured.
✓ Logged in to HuggingFace
Using device: cuda
================================================================================
Loading CODI-LLaMA from Local Checkpoint
================================================================================
/usr/local/lib/python3.12/dist-packages/huggingface_hub/file_download.py:942: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
`torch_dtype` is deprecated! Use `dtype` instead!
The new embeddings will be initialized from a multivariate normal distribution that has old embeddings' mean and covariance. As described in this article: https://nlp.stanford.edu/~johnhew/vocab-expansion.html. To disable this, use `mean_resizing=False`
trainable params: 98574336 || all params: 1334394880 || trainable%: 7.387193811774817

Loading clean variant examples...
✓ Loaded 132 clean variant examples

Processing examples...
  0%|          | 0/132 [00:00<?, ?it/s]  1%|          | 1/132 [00:00<02:09,  1.01it/s]  2%|▏         | 2/132 [00:01<01:51,  1.17it/s]  2%|▏         | 3/132 [00:02<01:44,  1.24it/s]  3%|▎         | 4/132 [00:03<01:41,  1.26it/s]  4%|▍         | 5/132 [00:04<01:39,  1.28it/s]  5%|▍         | 6/132 [00:04<01:38,  1.28it/s]  5%|▌         | 7/132 [00:05<01:36,  1.30it/s]  6%|▌         | 8/132 [00:06<01:35,  1.30it/s]  7%|▋         | 9/132 [00:07<01:33,  1.31it/s]  8%|▊         | 10/132 [00:07<01:32,  1.31it/s]  8%|▊         | 11/132 [00:08<01:31,  1.32it/s]  9%|▉         | 12/132 [00:09<01:31,  1.31it/s] 10%|▉         | 13/132 [00:10<01:30,  1.32it/s] 11%|█         | 14/132 [00:10<01:29,  1.32it/s] 11%|█▏        | 15/132 [00:11<01:29,  1.31it/s] 12%|█▏        | 16/132 [00:12<01:28,  1.31it/s] 13%|█▎        | 17/132 [00:13<01:28,  1.31it/s] 14%|█▎        | 18/132 [00:13<01:26,  1.31it/s] 14%|█▍        | 19/132 [00:14<01:26,  1.31it/s]
[20/132] Acc NO_INT=75.0%, WITH_INT=80.0%
 15%|█▌        | 20/132 [00:15<01:25,  1.31it/s] 16%|█▌        | 21/132 [00:16<01:24,  1.32it/s] 17%|█▋        | 22/132 [00:16<01:23,  1.32it/s] 17%|█▋        | 23/132 [00:17<01:23,  1.31it/s] 18%|█▊        | 24/132 [00:18<01:21,  1.32it/s] 19%|█▉        | 25/132 [00:19<01:20,  1.33it/s] 20%|█▉        | 26/132 [00:19<01:19,  1.34it/s] 20%|██        | 27/132 [00:20<01:18,  1.34it/s] 21%|██        | 28/132 [00:21<01:18,  1.33it/s] 22%|██▏       | 29/132 [00:22<01:18,  1.31it/s] 23%|██▎       | 30/132 [00:23<01:17,  1.31it/s] 23%|██▎       | 31/132 [00:23<01:16,  1.32it/s] 24%|██▍       | 32/132 [00:24<01:16,  1.31it/s] 25%|██▌       | 33/132 [00:25<01:15,  1.31it/s] 26%|██▌       | 34/132 [00:26<01:14,  1.31it/s] 27%|██▋       | 35/132 [00:26<01:13,  1.32it/s] 27%|██▋       | 36/132 [00:27<01:12,  1.32it/s] 28%|██▊       | 37/132 [00:28<01:11,  1.32it/s] 29%|██▉       | 38/132 [00:29<01:11,  1.32it/s] 30%|██▉       | 39/132 [00:29<01:10,  1.32it/s]
[40/132] Acc NO_INT=82.5%, WITH_INT=77.5%
 30%|███       | 40/132 [00:30<01:09,  1.32it/s] 31%|███       | 41/132 [00:31<01:09,  1.32it/s] 32%|███▏      | 42/132 [00:32<01:08,  1.32it/s] 33%|███▎      | 43/132 [00:32<01:07,  1.31it/s] 33%|███▎      | 44/132 [00:33<01:06,  1.32it/s] 34%|███▍      | 45/132 [00:34<01:05,  1.32it/s] 35%|███▍      | 46/132 [00:35<01:05,  1.32it/s] 36%|███▌      | 47/132 [00:35<01:04,  1.32it/s] 36%|███▋      | 48/132 [00:36<01:03,  1.31it/s] 37%|███▋      | 49/132 [00:37<01:03,  1.31it/s] 38%|███▊      | 50/132 [00:38<01:02,  1.32it/s] 39%|███▊      | 51/132 [00:38<01:01,  1.32it/s] 39%|███▉      | 52/132 [00:39<01:00,  1.32it/s] 40%|████      | 53/132 [00:40<00:59,  1.32it/s] 41%|████      | 54/132 [00:41<00:59,  1.31it/s] 42%|████▏     | 55/132 [00:42<00:58,  1.31it/s] 42%|████▏     | 56/132 [00:42<00:59,  1.28it/s] 43%|████▎     | 57/132 [00:43<00:58,  1.29it/s] 44%|████▍     | 58/132 [00:44<00:57,  1.29it/s] 45%|████▍     | 59/132 [00:45<00:56,  1.29it/s]
[60/132] Acc NO_INT=86.7%, WITH_INT=81.7%
 45%|████▌     | 60/132 [00:45<00:55,  1.30it/s] 46%|████▌     | 61/132 [00:46<00:54,  1.30it/s] 47%|████▋     | 62/132 [00:47<00:53,  1.31it/s] 48%|████▊     | 63/132 [00:48<00:52,  1.31it/s] 48%|████▊     | 64/132 [00:48<00:52,  1.30it/s] 49%|████▉     | 65/132 [00:49<00:51,  1.30it/s] 50%|█████     | 66/132 [00:50<00:50,  1.30it/s] 51%|█████     | 67/132 [00:51<00:49,  1.30it/s] 52%|█████▏    | 68/132 [00:52<00:49,  1.30it/s] 52%|█████▏    | 69/132 [00:52<00:48,  1.30it/s] 53%|█████▎    | 70/132 [00:53<00:47,  1.30it/s] 54%|█████▍    | 71/132 [00:54<00:46,  1.31it/s] 55%|█████▍    | 72/132 [00:55<00:45,  1.31it/s] 55%|█████▌    | 73/132 [00:55<00:44,  1.31it/s] 56%|█████▌    | 74/132 [00:56<00:44,  1.31it/s] 57%|█████▋    | 75/132 [00:57<00:43,  1.31it/s] 58%|█████▊    | 76/132 [00:58<00:42,  1.31it/s] 58%|█████▊    | 77/132 [00:58<00:41,  1.31it/s] 59%|█████▉    | 78/132 [00:59<00:41,  1.31it/s] 60%|█████▉    | 79/132 [01:00<00:40,  1.31it/s]
[80/132] Acc NO_INT=88.8%, WITH_INT=78.8%
 61%|██████    | 80/132 [01:01<00:39,  1.31it/s] 61%|██████▏   | 81/132 [01:01<00:38,  1.31it/s] 62%|██████▏   | 82/132 [01:02<00:37,  1.32it/s] 63%|██████▎   | 83/132 [01:03<00:37,  1.32it/s] 64%|██████▎   | 84/132 [01:04<00:36,  1.33it/s] 64%|██████▍   | 85/132 [01:04<00:35,  1.33it/s] 65%|██████▌   | 86/132 [01:05<00:34,  1.33it/s] 66%|██████▌   | 87/132 [01:06<00:33,  1.33it/s] 67%|██████▋   | 88/132 [01:07<00:33,  1.33it/s] 67%|██████▋   | 89/132 [01:07<00:32,  1.33it/s] 68%|██████▊   | 90/132 [01:08<00:31,  1.33it/s] 69%|██████▉   | 91/132 [01:09<00:30,  1.33it/s] 70%|██████▉   | 92/132 [01:10<00:30,  1.33it/s] 70%|███████   | 93/132 [01:10<00:29,  1.33it/s] 71%|███████   | 94/132 [01:11<00:28,  1.33it/s] 72%|███████▏  | 95/132 [01:12<00:27,  1.33it/s] 73%|███████▎  | 96/132 [01:13<00:27,  1.33it/s] 73%|███████▎  | 97/132 [01:13<00:26,  1.33it/s] 74%|███████▍  | 98/132 [01:14<00:25,  1.33it/s] 75%|███████▌  | 99/132 [01:15<00:24,  1.33it/s]
[100/132] Acc NO_INT=87.0%, WITH_INT=78.0%
 76%|███████▌  | 100/132 [01:16<00:23,  1.33it/s] 77%|███████▋  | 101/132 [01:16<00:23,  1.33it/s] 77%|███████▋  | 102/132 [01:17<00:22,  1.33it/s] 78%|███████▊  | 103/132 [01:18<00:21,  1.33it/s] 79%|███████▉  | 104/132 [01:19<00:21,  1.33it/s] 80%|███████▉  | 105/132 [01:19<00:20,  1.33it/s] 80%|████████  | 106/132 [01:20<00:19,  1.34it/s] 81%|████████  | 107/132 [01:21<00:18,  1.34it/s] 82%|████████▏ | 108/132 [01:22<00:17,  1.34it/s] 83%|████████▎ | 109/132 [01:22<00:17,  1.34it/s] 83%|████████▎ | 110/132 [01:23<00:16,  1.34it/s] 84%|████████▍ | 111/132 [01:24<00:15,  1.34it/s] 85%|████████▍ | 112/132 [01:25<00:14,  1.33it/s] 86%|████████▌ | 113/132 [01:25<00:14,  1.34it/s] 86%|████████▋ | 114/132 [01:26<00:13,  1.34it/s] 87%|████████▋ | 115/132 [01:27<00:12,  1.34it/s] 88%|████████▊ | 116/132 [01:28<00:11,  1.33it/s] 89%|████████▊ | 117/132 [01:28<00:11,  1.32it/s] 89%|████████▉ | 118/132 [01:29<00:10,  1.33it/s] 90%|█████████ | 119/132 [01:30<00:09,  1.33it/s]
[120/132] Acc NO_INT=89.2%, WITH_INT=78.3%
 91%|█████████ | 120/132 [01:31<00:09,  1.33it/s] 92%|█████████▏| 121/132 [01:31<00:08,  1.33it/s] 92%|█████████▏| 122/132 [01:32<00:07,  1.33it/s] 93%|█████████▎| 123/132 [01:33<00:06,  1.33it/s] 94%|█████████▍| 124/132 [01:34<00:05,  1.34it/s] 95%|█████████▍| 125/132 [01:34<00:05,  1.33it/s] 95%|█████████▌| 126/132 [01:35<00:04,  1.33it/s] 96%|█████████▌| 127/132 [01:36<00:03,  1.34it/s] 97%|█████████▋| 128/132 [01:37<00:02,  1.33it/s] 98%|█████████▊| 129/132 [01:37<00:02,  1.34it/s] 98%|█████████▊| 130/132 [01:38<00:01,  1.34it/s] 99%|█████████▉| 131/132 [01:39<00:00,  1.33it/s]100%|██████████| 132/132 [01:40<00:00,  1.33it/s]100%|██████████| 132/132 [01:40<00:00,  1.32it/s]

================================================================================
Final Results:
================================================================================
Total examples: 132
Accuracy WITHOUT intervention: 90.15% (119/132)
Accuracy WITH intervention: 80.30% (106/132)
Difference: -9.85%

Answers that changed due to intervention: 19/132 (14.4%)

✓ Results saved to /workspace/CoT_Exploration/src/experiments/28-10-2028-projection-replacement/projection_replacement_clean/results/llama_intervention_results_clean.json
