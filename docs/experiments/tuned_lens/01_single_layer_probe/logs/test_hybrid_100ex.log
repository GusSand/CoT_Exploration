/workspace/CoT_Exploration/env/lib/python3.12/site-packages/huggingface_hub/file_download.py:943: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
The new embeddings will be initialized from a multivariate normal distribution that has old embeddings' mean and covariance. As described in this article: https://nlp.stanford.edu/~johnhew/vocab-expansion.html. To disable this, use `mean_resizing=False`
/workspace/CoT_Exploration/env/lib/python3.12/site-packages/peft/tuners/lora/layer.py:1768: UserWarning: fan_in_fan_out is set to False but the target module is `Conv1D`. Setting fan_in_fan_out to True.
  warnings.warn(
Passing a tuple of `past_key_values` is deprecated and will be removed in Transformers v4.53.0. You should pass an instance of `Cache` instead, e.g. `past_key_values=DynamicCache.from_legacy_cache(past_key_values)`.
====================================================================================================
CODI PROBE TEST EVALUATION
====================================================================================================
====================================================================================================
LOADING CODI MODEL
====================================================================================================
trainable params: 20057088 || all params: 144499200 || trainable%: 13.880414562848792
Model loaded: n_layer=12, has_prj=True
====================================================================================================

Probe loaded from: outputs/probe_hybrid/probe_L10_to_L11_HYBRID_20251028_141404.pt

====================================================================================================
TESTING PROBE ON TEST SET
====================================================================================================
Probe: outputs/probe_hybrid/probe_L10_to_L11_HYBRID_20251028_141404.pt
Source layer: 10
Target layer: 11
Test examples: 100
====================================================================================================

----------------------------------------------------------------------------------------------------
Example 1: Janet’s ducks lay 16 eggs per day. She eats three for breakf...
  Iter 1: Probe='>' vs Target='9' ✗
  Iter 2: Probe='-' vs Target='-' ✓
  Iter 3: Probe=' 7' vs Target=' 5' ✗
  Iter 4: Probe='-' vs Target='-' ✓
  Iter 5: Probe=' 3' vs Target=' 5' ✗
  Iter 6: Probe='-' vs Target='-' ✓

----------------------------------------------------------------------------------------------------
Example 2: A robe takes 2 bolts of blue fiber and half that much white ...
  Iter 1: Probe='1' vs Target='1' ✓
  Iter 2: Probe=' almost' vs Target='>>' ✗
  Iter 3: Probe='1' vs Target='1' ✓
  Iter 4: Probe='st' vs Target='>>' ✗
  Iter 5: Probe='1' vs Target='1' ✓
  Iter 6: Probe=')' vs Target='>>' ✗

----------------------------------------------------------------------------------------------------
Example 3: Josh decides to try flipping a house.  He buys a house for $...
  Iter 1: Probe=':' vs Target='live' ✗
  Iter 2: Probe=' every' vs Target=' <<' ✗
  Iter 3: Probe='mental' vs Target=' answer' ✗
  Iter 4: Probe=' resulting' vs Target=' <<' ✗
  Iter 5: Probe='ST' vs Target=' Raise' ✗
  Iter 6: Probe='666' vs Target=' <<' ✗

----------------------------------------------------------------------------------------------------
Example 4: James decides to run 3 sprints 3 times a week.  He runs 60 m...
  Iter 1: Probe='180' vs Target='180' ✓
  Iter 2: Probe='?"' vs Target='*' ✗
  Iter 3: Probe=' 9' vs Target='9' ✗
  Iter 4: Probe='>>' vs Target='>>' ✓
  Iter 5: Probe='ris' vs Target='9' ✗
  Iter 6: Probe='>>' vs Target='>>' ✓

----------------------------------------------------------------------------------------------------
Example 5: Every day, Wendi feeds each of her chickens three cups of mi...
  Iter 1: Probe=' 60' vs Target=' 60' ✓
  Iter 2: Probe='~' vs Target=',' ✗
  Iter 3: Probe='40' vs Target=' 40' ✗
  Iter 4: Probe='+' vs Target=',' ✗
  Iter 5: Probe='40' vs Target=' 40' ✗
  Iter 6: Probe='~' vs Target=',' ✗

Processed 100/100 examples... Running accuracy: 32.67%

====================================================================================================
TEST RESULTS
====================================================================================================
Overall Accuracy: 196/600 = 32.67%

Per-Iteration Accuracy:
  Iteration 1: 29/100 = 29.00%
  Iteration 2: 37/100 = 37.00%
  Iteration 3: 32/100 = 32.00%
  Iteration 4: 35/100 = 35.00%
  Iteration 5: 26/100 = 26.00%
  Iteration 6: 37/100 = 37.00%
====================================================================================================
